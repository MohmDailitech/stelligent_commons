{
  "AWSTemplateFormatVersion":"2010-09-09",
  "Description":"Dromedary CodePipeline Custom Action Provisioning",
  "Parameters":{
    "Version":{
      "Type":"String",
      "Default":"1"
    }
  },
  "Resources":{
    "OpsWorksViaLambdaCustomActionType":{
      "Type":"AWS::CodePipeline::CustomActionType",
      "Properties":{
        "Category":"Deploy",
        "Provider":{
          "Ref":"AWS::StackName"
        },
        "Version":{
          "Ref":"Version"
        },
        "ConfigurationProperties":[
          {
            "Name":"Deploy-Bucket",
            "Required":true,
            "Key":false,
            "Secret":false
          },
          {
            "Name":"OpsWorks-Stack-ID",
            "Required":true,
            "Key":false,
            "Secret":false
          },
          {
            "Name":"OpsWorks-App-ID",
            "Required":true,
            "Key":true,
            "Secret":false
          }
        ],
        "InputArtifactDetails":{
          "MinimumCount":1,
          "MaximumCount":1
        },
        "OutputArtifactDetails":{
          "MinimumCount":0,
          "MaximumCount":0
        }
      }
    }
  },
  "Outputs":{
    "StackName":{
      "Value":{
        "Ref":"AWS::StackName"
      }
    },
    "OpsWorksViaLambdaCustomActionType":{
      "Description":"CodePipeline Deploy Custom action name",
      "Value":{
        "Ref":"AWS::StackName"
      }
    }
  }
}